<div class="form-element-align">
  <h1>Instagram media downloader</h1>
</div>
<div class="form-actions">
  <%= link_to "Another download".html_safe,
              new_search_path,
              :class => 'btn btn-primary',
              data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Going to another download ..."} %>
  <%= link_to "Zip to Disk".html_safe,
              search_path(@search),
              method: :delete,
              :class => 'btn btn-primary'%>

</div>
<br>
<div class="container">
  <div class="row">
    <div class="row">
      <% files = Dir.glob("./public/dwlds/#{session[:session_id]}/**/*") %>
      <% files.each do |f| %>
        <% if File.extname(f) == '.mp4' %>
          <div class="col-lg-3 col-md-4 col-xs-6 thumb">
            <a data-toggle="modal" href="#mediaModal" data-target="#mediaModal">
              <video width="426" height="240" class="img-fluid rounded">
                <source src="<%= f.to_s.gsub!('./public/', '/') %>" type="video/mp4" >
              </video>
            </a>
          </div>
        <% elsif File.extname(f) != '.zip' %>
          <div class="col-lg-3 col-md-4 col-xs-6 thumb">
            <a data-toggle="modal" href="#mediaModal" data-target="#mediaModal">
            <img src="<%= f.to_s.gsub!('./public/', '/') %>" class="img-fluid rounded">
            </a>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="mediaModal" tabindex="-1" role="dialog" aria-labelledby="mediaModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <div id="carouselMedia" class="carousel slide" data-ride="carousel">
          <ol class="carousel-indicators">
            <% files.each do |g| %>
              <li data-target="#carouselMedia" data-slide-to="<%= files.index(g) %>" class="are<%= files.index(g) == 0 ? ' active' : ''%>" ></li>
            <% end %>
          </ol>
          <div class="carousel-inner">

            <% files.each do |h| %>
              <% if File.extname(h) != '.zip' %>
                <div class="carousel-item<%= files.index(h) == 0 ? ' active' : ''%>">
                  <% if File.extname(h) == '.mp4' %>
                      <video controls="controls" class="rounded w-100">
                         <source src="<%= h %>" type="video/mp4" class="img-fluid rounded">
                      </video>
                  <% else %>
                      <img class="rounded w-100" src="<%= h %>">
                  <% end %>
                </div>
              <% end %>
            <% end %>

          </div>
          <a class="carousel-control-prev" href="#carouselMedia" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselMedia" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>

      </div>
    </div>
  </div>
</div>
